@inject IViewLocalizer Localizer
@model CommunityCar.Application.Features.Dashboard.Reports.ViewModels.ReportGenerationVM
@{
    ViewData["Title"] = Localizer["ReportDetailsTitle"];
    ViewData["PageType"] = "Reports";
}

<div class="space-y-10 animate-in fade-in duration-1000">
    <!-- Navigation & Header Strategy -->
    <div class="flex flex-col md:flex-row md:items-end justify-between gap-8 px-2">
        <div class="space-y-4">
            <nav class="flex items-center gap-3 text-[10px] font-black uppercase tracking-[0.3em] text-primary mb-6">
                <i data-lucide="file-text" class="w-3.5 h-3.5 fill-current"></i> @Localizer["AnalyticsReportTransmission"]
            </nav>
            <h1 class="text-5xl font-black text-foreground tracking-tighter leading-none">@Localizer["ReportDetails"]</h1>
            <p class="text-sm font-medium text-muted-foreground opacity-70 mt-4 border-l-4 border-primary/20 pl-4 py-1 max-w-2xl">@Localizer["ReportDetailsDesc"]</p>
        </div>
        
        <div class="flex gap-3">
            <a href="/Dashboard/Reports" class="inline-flex items-center justify-center gap-2.5 px-6 py-2.5 bg-background border border-border/50 hover:bg-muted/10 text-foreground text-[10px] font-black uppercase tracking-widest rounded-xl transition-all active:scale-95 group/back">
                <i data-lucide="arrow-left" class="w-4 h-4 group-hover/back:-translate-x-1 transition-transform"></i>
                @Localizer["ReturnToRegistry"]
            </a>
        </div>
    </div>

        <!-- Success/Error Messages -->
        @if (TempData["SuccessMessage"] != null)
        {
            <div class="mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg">
                @TempData["SuccessMessage"]
            </div>
        }
        @if (TempData["ErrorMessage"] != null)
        {
            <div class="mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg">
                @TempData["ErrorMessage"]
            </div>
        }

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
            <!-- Report Core Information -->
            <div class="lg:col-span-2 space-y-8">
                <div class="eng-card pointer-events-auto p-8 md:p-12 overflow-hidden relative group">
                    <div class="absolute top-0 right-0 w-96 h-96 bg-primary/5 rounded-full blur-3xl -mr-48 -mt-48"></div>
                    
                    <div class="flex items-center gap-3 mb-10 relative z-10">
                        <div class="w-1.5 h-6 bg-primary rounded-full"></div>
                        <h3 class="text-xl font-black text-foreground tracking-tight">@Localizer["ReportPayloadConfiguration"]</h3>
                    </div>

                    <div class="space-y-10 relative z-10">
                        <!-- Report Type -->
                        <div class="space-y-4">
                            <label class="text-[10px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["Classification"]</label>
                            <div class="text-2xl font-black text-foreground">@Model?.ReportType</div>
                        </div>

                        <!-- Date Range Registry -->
                        <div class="grid grid-cols-2 gap-12 pt-4 border-t border-border/30">
                            <div class="space-y-4">
                                <label class="text-[10px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["TemporalStart"]</label>
                                <div class="text-xl font-black text-foreground tabular-nums">@Model?.StartDate.ToString("MMMM dd, yyyy")</div>
                            </div>
                            <div class="space-y-4">
                                <label class="text-[10px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["TemporalEnd"]</label>
                                <div class="text-xl font-black text-foreground tabular-nums">@Model?.EndDate.ToString("MMMM dd, yyyy")</div>
                            </div>
                        </div>

                        <!-- Parameter Matrix -->
                        @if (Model?.Parameters != null && Model.Parameters.Any())
                        {
                            <div class="space-y-6 pt-10 border-t border-border/30">
                                <label class="text-[10px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["ParameterMatrix"]</label>
                                <div class="bg-muted/30 border border-border/50 rounded-2xl p-6">
                                    <div class="grid gap-4">
                                        @foreach (var param in Model.Parameters)
                                        {
                                            <div class="flex justify-between items-center py-2 border-b border-border/20 last:border-0">
                                                <span class="text-[10px] font-black uppercase tracking-widest text-muted-foreground">@param.Key</span>
                                                <span class="text-xs font-bold text-foreground font-mono">@param.Value</span>
                                            </div>
                                        }
                                    </div>
                                </div>
                            </div>
                        }

                        <!-- Visualization Preview -->
                        <div class="pt-10 border-t border-border/30">
                            <div class="bg-primary/5 border border-primary/20 rounded-3xl p-10 text-center group/preview">
                                <i data-lucide="bar-chart-3" class="w-16 h-16 text-primary mx-auto mb-6 group-hover/preview:scale-110 transition-transform duration-500"></i>
                                <h3 class="text-xl font-black text-foreground mb-4">@Localizer["ArchivePreview"]</h3>
                                <p class="text-sm font-medium text-muted-foreground leading-relaxed max-w-sm mx-auto mb-8">
                                    @Localizer["ArchivePreviewDesc"]
                                </p>
                                <div class="flex flex-wrap justify-center gap-8 text-[10px] font-black uppercase tracking-widest text-muted-foreground/60">
                                    <span class="flex items-center gap-2"><div class="w-1 h-1 bg-primary rounded-full"></div> @string.Format(Localizer["DataPointsCount"].Value, "1,234") @Localizer["DataPoints"]</span>
                                    <span class="flex items-center gap-2"><div class="w-1 h-1 bg-primary rounded-full"></div> @string.Format(Localizer["VisualizationsCount"].Value, 5) @Localizer["Visualizations"]</span>
                                    <span class="flex items-center gap-2"><div class="w-1 h-1 bg-primary rounded-full"></div> @string.Format(Localizer["DataTablesCount"].Value, 3) @Localizer["DataTables"]</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Operational Sidebar -->
            <div class="space-y-8">
                <!-- Lifecycle Status -->
                <div class="bg-card/40 backdrop-blur-xl border border-border/50 rounded-[2.5rem] p-8 shadow-xl">
                    <div class="flex items-center gap-3 mb-8">
                        <div class="w-1 h-4 bg-primary rounded-full"></div>
                        <h3 class="text-sm font-black text-foreground tracking-widest uppercase">@Localizer["LifecycleStatus"]</h3>
                    </div>

                    <div class="space-y-8">
                        <div class="flex items-center justify-between">
                            <span class="text-[10px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["CurrentState"]</span>
                            <span class="px-3 py-1 bg-green-500/10 text-green-500 border border-green-500/20 rounded-xl text-[10px] font-black uppercase tracking-widest">@Localizer["CompletedBit"]</span>
                        </div>

                        <div class="space-y-3">
                            <div class="flex items-center justify-between text-[10px] font-black uppercase tracking-widest">
                                <span class="text-muted-foreground">@Localizer["ProgressLock"]</span>
                                <span class="text-primary">100%_@Localizer["Read"]</span>
                            </div>
                            <div class="eng-progress-container h-1.5 bg-muted/20">
                                <div class="eng-progress-bar bg-primary shadow-glow-primary w-full"></div>
                            </div>
                        </div>

                        <div class="pt-6 border-t border-border/30 space-y-6">
                            <div class="space-y-2">
                                <div class="text-[9px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["CreationStamp"]</div>
                                <div class="text-[11px] font-bold text-foreground tabular-nums font-mono">@DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")</div>
                            </div>
                            <div class="space-y-2">
                                <div class="text-[9px] font-black uppercase tracking-widest text-muted-foreground opacity-40">@Localizer["PayloadVolume"]</div>
                                <div class="text-[11px] font-bold text-foreground tabular-nums font-mono">2.54_MB</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Execution Protocols -->
                <div class="bg-card/40 backdrop-blur-xl border border-border/50 rounded-[2.5rem] p-8 shadow-xl">
                    <div class="flex items-center gap-3 mb-8">
                        <div class="w-1 h-4 bg-primary rounded-full"></div>
                        <h3 class="text-sm font-black text-foreground tracking-widest uppercase">@Localizer["TerminalActions"]</h3>
                    </div>

                    <div class="space-y-4">
                        <button class="inline-flex items-center justify-start w-full px-6 h-14 bg-primary text-primary-foreground hover:bg-primary/90 font-black uppercase tracking-widest rounded-xl transition-all shadow-lg shadow-primary/20 active:scale-95 group/download">
                            <i data-lucide="download" class="w-5 h-5 mr-4 group-hover/download:translate-y-0.5 transition-transform"></i> @Localizer["TransmitPayload"]
                        </button>
                        <button class="inline-flex items-center justify-start w-full px-6 h-14 bg-muted/20 border border-border/50 hover:bg-muted/30 text-foreground font-black uppercase tracking-widest rounded-xl transition-all active:scale-95 group/share">
                            <i data-lucide="share-2" class="w-5 h-5 mr-4 opacity-70 group-hover/share:scale-110 transition-transform"></i> @Localizer["BroadcastData"]
                        </button>
                        <button class="inline-flex items-center justify-start w-full px-6 h-14 bg-background border border-border/50 hover:border-red-500/50 hover:text-red-500 font-black uppercase tracking-widest rounded-xl transition-all active:scale-95 group/purge">
                            <i data-lucide="trash-2" class="w-5 h-5 mr-4 group-hover/purge:rotate-12 transition-transform"></i> @Localizer["PurgeArchive"]
                        </button>
                    </div>
                </div>

                <!-- Scheduling -->
                <div class="bg-card/40 backdrop-blur-xl border border-border/50 rounded-[2.5rem] p-8 shadow-xl">
                    <div class="flex items-center gap-3 mb-6">
                        <div class="w-1 h-4 bg-blue-500 rounded-full"></div>
                        <h3 class="text-sm font-black text-foreground tracking-widest uppercase text-blue-500">@Localizer["AutomationSync"]</h3>
                    </div>
                    <p class="text-xs font-medium text-muted-foreground mb-6 leading-relaxed opacity-70">
                        @Localizer["AutomationSyncDesc"]
                    </p>
                    <button class="inline-flex items-center justify-center w-full h-12 bg-muted/20 border border-blue-500/20 text-blue-500 hover:bg-blue-500/10 font-black uppercase tracking-widest rounded-xl transition-all active:scale-95">
                        @Localizer["InitSchedule"]
                    </button>
                </div>
            </div>
        </div>
    </div> <!-- Close report-content and container divs properly -->
        </div> <!-- End report-content -->
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            Skeleton.initPageLoad('report-skeleton', 'report-content');
        });
        
        // Auto-refresh status for reports that are still processing
        function checkReportStatus() {
            // This would make an AJAX call to check report status
            console.log('Checking report status...');
        }

        // Check status every 10 seconds if report is still processing
        const status = 'Completed'; // This would come from the model
        if (status !== 'Completed' && status !== 'Failed') {
            setInterval(checkReportStatus, 10000);
        }
    </script>
}