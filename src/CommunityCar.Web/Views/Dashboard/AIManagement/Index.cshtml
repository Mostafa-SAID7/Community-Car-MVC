@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    ViewData["Title"] = Localizer["AIManagementDashboard"];
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
    ViewData["UseModernTheme"] = true;
}

<div class="animate-slide-up">
    <!-- Top Header Section -->
    <div class="d-flex justify-content-between align-items-center mb-5">
        <div>
            <h1 class="page-title mb-2">@Localizer["AIManagementDashboard"]</h1>
            <p class="text-muted fw-medium">@Localizer["MonitorManageAI"]</p>
        </div>
        <div class="d-flex align-items-center gap-3">
            <a asp-action="Test" class="btn-modern-outline d-flex align-items-center gap-2">
                <i data-lucide="flask-conical" class="w-4 h-4"></i>
                @Localizer["TestConsole"]
            </a>
            <a asp-action="Training" class="btn-modern-primary">
                <i data-lucide="brain" class="w-5 h-5"></i>
                @Localizer["TrainingCenter"]
            </a>
        </div>
    </div>

    <!-- Stats Row -->
    <div class="row g-4 mb-5">
        <div class="col-12 col-md-6 col-lg-3">
            <div class="card-modern p-4 d-flex align-items-center gap-3">
                <div class="w-12 h-12 rounded-circle bg-light d-flex align-items-center justify-content-center text-primary">
                    <i data-lucide="message-circle" class="w-6 h-6"></i>
                </div>
                <div>
                    <p class="modern-label mb-0">@Localizer["TotalConversations"]</p>
                    <h3 class="fw-black mb-0">@(Model?.TotalConversations ?? 0)</h3>
                    <span class="xx-small text-success fw-bold">+@(Model?.WeeklyGrowth ?? 0)% @Localizer["ThisWeek"]</span>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
            <div class="card-modern p-4 d-flex align-items-center gap-3">
                <div class="w-12 h-12 rounded-circle bg-light d-flex align-items-center justify-content-center text-success">
                    <i data-lucide="users" class="w-6 h-6"></i>
                </div>
                <div>
                    <p class="modern-label mb-0">@Localizer["ActiveUsers"]</p>
                    <h3 class="fw-black mb-0">@(Model?.ActiveUsers ?? 0)</h3>
                    <span class="xx-small text-muted fw-bold">@Localizer["CurrentlyOnline"]</span>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
            <div class="card-modern p-4 d-flex align-items-center gap-3">
                <div class="w-12 h-12 rounded-circle bg-light d-flex align-items-center justify-content-center text-warning">
                    <i data-lucide="zap" class="w-6 h-6"></i>
                </div>
                <div>
                    <p class="modern-label mb-0">@Localizer["ResponseTime"]</p>
                    <h3 class="fw-black mb-0">@(Model?.ResponseTime ?? "N/A")</h3>
                    <span class="xx-small text-muted fw-bold">@Localizer["AverageResponse"]</span>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
            <div class="card-modern p-4 d-flex align-items-center gap-3">
                <div class="w-12 h-12 rounded-circle bg-light d-flex align-items-center justify-content-center text-info">
                    <i data-lucide="heart" class="w-6 h-6"></i>
                </div>
                <div>
                    <p class="modern-label mb-0">@Localizer["SatisfactionRate"]</p>
                    <h3 class="fw-black mb-0">@(Model?.SatisfactionRate ?? 0)%</h3>
                    <span class="xx-small text-success fw-bold">@Localizer["Excellent"] @Localizer["Rating"]</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="row g-4 mb-5">
        <div class="col-12 col-lg-7">
            <div class="card-modern">
                <h5 class="fw-black mb-4 d-flex align-items-center gap-2">
                    <i data-lucide="activity" class="w-5 h-5 opacity-40"></i>
                    @Localizer["RecentActivity"]
                </h5>
                <div class="d-flex flex-column gap-1">
                    @if (Model?.RecentActivity != null)
                    {
                        @foreach (var activity in Model.RecentActivity)
                        {
                            <div class="modern-activity-item">
                                <div class="modern-activity-icon">
                                    <i data-lucide="user" class="w-5 h-5 text-muted"></i>
                                </div>
                                <div class="flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-center mb-1">
                                        <span class="fw-bold small">@activity.User</span>
                                        <span class="xx-small text-muted opacity-60">@activity.Time</span>
                                    </div>
                                    <p class="small text-muted mb-0">@activity.Message</p>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="text-center py-5 opacity-40">
                            <i data-lucide="inbox" class="w-10 h-10 mb-3"></i>
                            <p class="small fw-bold">@Localizer["NoRecentActivity"]</p>
                        </div>
                    }
                </div>
            </div>
        </div>

        <div class="col-12 col-lg-5">
            <div class="card-modern">
                <h5 class="fw-black mb-4 d-flex align-items-center gap-2">
                    <i data-lucide="target" class="w-5 h-5 opacity-40"></i>
                    @Localizer["TopIntents"]
                </h5>
                <div class="d-flex flex-column gap-4">
                    @if (Model?.TopIntents != null)
                    {
                        @foreach (var intent in Model.TopIntents)
                        {
                            var width = new Random().Next(40, 95);
                            <div>
                                <div class="d-flex justify-content-between align-items-center mb-2">
                                    <span class="fw-bold small">@intent</span>
                                    <span class="xx-small fw-black">@width%</span>
                                </div>
                                <div class="modern-progress">
                                    <div class="modern-progress-bar @(width > 80 ? "bg-dark" : "bg-modern-lime")" style="width: @width%; @(width <= 80 ? "background-color: var(--modern-lime);" : "")"></div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="text-center py-5 opacity-40">
                            <i data-lucide="bar-chart" class="w-10 h-10 mb-3"></i>
                            <p class="small fw-bold">@Localizer["NoIntentData"]</p>
                        </div>
                    }
                </div>
            </div>

            <div class="card-modern card-modern-dark mt-4 p-4">
                <h6 class="fw-black mb-3">@Localizer["AIModelsStatus"]</h6>
                <div class="d-flex flex-column gap-3">
                    <div class="d-flex justify-content-between align-items-center">
                        <span class="small opacity-60">@Localizer["ActiveModels"]</span>
                        <span class="fw-black">@(Model?.ActiveModels ?? 0)</span>
                    </div>
                    <div class="modern-progress" style="background: rgba(255,255,255,0.1); height: 4px;">
                        <div class="modern-progress-bar bg-white" style="width: 100%;"></div>
                    </div>
                    <div class="d-flex justify-content-between align-items-center mt-2">
                        <span class="small opacity-60">@Localizer["TrainingJobs"]</span>
                        <span class="fw-black">@(Model?.TrainingJobs ?? 0)</span>
                    </div>
                    <div class="modern-progress" style="background: rgba(255,255,255,0.1); height: 4px;">
                        <div class="modern-progress-bar bg-white opacity-40" style="width: 30%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });
    </script>
}
