@inject IViewLocalizer Localizer
@{
    ViewData["Title"] = Localizer["ErrorReportsTitle"];
    Layout = "_DashboardLayout";
}

<div class="animate-slide-up">
    <!-- Header -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-4 mb-4">
        <div>
            <h1 class="page-title mb-1">
                <i data-lucide="flag" class="text-muted opacity-40 me-2"></i>
                @Localizer["ErrorReports"]
            </h1>
            <p class="text-muted small">@Localizer["ErrorReportsDesc"]</p>
        </div>
        
        <div class="d-flex flex-wrap align-items-center gap-2">
            <select id="statusFilter" class="form-select form-select-sm border-0 shadow-sm rounded-pill px-3" style="width: auto; min-width: 140px;">
                <option value="">@Localizer["AllStatus"]</option>
                <option value="new">@Localizer["StatusNew"]</option>
                <option value="in-progress">@Localizer["StatusInProgress"]</option>
                <option value="resolved">@Localizer["StatusResolved"]</option>
                <option value="closed">@Localizer["StatusClosed"]</option>
            </select>
            <select id="priorityFilter" class="form-select form-select-sm border-0 shadow-sm rounded-pill px-3" style="width: auto; min-width: 140px;">
                <option value="">@Localizer["AllPriority"]</option>
                <option value="Critical">@Localizer["PriorityCritical"]</option>
                <option value="High">@Localizer["PriorityHigh"]</option>
                <option value="Medium">@Localizer["PriorityMedium"]</option>
                <option value="Low">@Localizer["PriorityLow"]</option>
            </select>
        </div>
    </div>

    <!-- Stats Cards -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-sm-6 col-xl-3">
            <div class="card-modern border-start border-4 border-danger">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small fw-bold">@Localizer["CriticalIssues"]</span>
                    <i data-lucide="alert-triangle" class="text-danger w-5 h-5"></i>
                </div>
                <h2 class="display-6 fw-black mb-0" id="criticalCount">0</h2>
                <div class="progress mt-3" style="height: 4px; background: rgba(0,0,0,0.05)">
                    <div class="progress-bar bg-danger" style="width: 15%"></div>
                </div>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-xl-3">
            <div class="card-modern border-start border-4 border-warning">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small fw-bold">@Localizer["HighPriority"]</span>
                    <i data-lucide="alert-circle" class="text-warning w-5 h-5"></i>
                </div>
                <h2 class="display-6 fw-black mb-0" id="highCount">0</h2>
                <div class="progress mt-3" style="height: 4px; background: rgba(0,0,0,0.05)">
                    <div class="progress-bar bg-warning" style="width: 25%"></div>
                </div>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-xl-3">
            <div class="card-modern border-start border-4 border-primary">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small fw-bold">@Localizer["InProgress"]</span>
                    <i data-lucide="clock" class="text-primary w-5 h-5"></i>
                </div>
                <h2 class="display-6 fw-black mb-0" id="inProgressCount">0</h2>
                <div class="progress mt-3" style="height: 4px; background: rgba(0,0,0,0.05)">
                    <div class="progress-bar bg-primary" style="width: 45%"></div>
                </div>
            </div>
        </div>
        <div class="col-12 col-sm-6 col-xl-3">
            <div class="card-modern border-start border-4 border-success">
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-muted small fw-bold">@Localizer["Resolved"]</span>
                    <i data-lucide="check-circle" class="text-success w-5 h-5"></i>
                </div>
                <h2 class="display-6 fw-black mb-0" id="resolvedCount">0</h2>
                <div class="progress mt-3" style="height: 4px; background: rgba(0,0,0,0.05)">
                    <div class="progress-bar bg-success" style="width: 85%"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Reports Table -->
    <div class="card-modern p-0 overflow-hidden">
        <div class="p-4 border-b border-light d-flex justify-content-between align-items-center">
            <h3 class="h6 fw-bold mb-0">
                <i data-lucide="list" class="text-muted me-2 w-4 h-4"></i>
                @Localizer["RecentErrorReports"]
            </h3>
            <button class="btn btn-sm btn-light rounded-pill">View All</button>
        </div>
        
        <div class="table-responsive">
            <table class="table table-hover align-middle mb-0">
                <thead class="bg-light bg-opacity-50">
                    <tr>
                        <th class="ps-4 border-0 xx-small text-uppercase tracking-wider">@Localizer["TicketID"]</th>
                        <th class="border-0 xx-small text-uppercase tracking-wider">@Localizer["User"]</th>
                        <th class="border-0 xx-small text-uppercase tracking-wider">@Localizer["Priority"]</th>
                        <th class="border-0 xx-small text-uppercase tracking-wider">@Localizer["Status"]</th>
                        <th class="border-0 xx-small text-uppercase tracking-wider text-center">@Localizer["Actions"]</th>
                    </tr>
                </thead>
                <tbody id="reportsTableBody">
                    <tr class="border-bottom border-light">
                        <td class="ps-4 py-3">
                            <span class="font-monospace xx-small bg-light px-2 py-1 rounded">ERR-2026-ABC</span>
                        </td>
                        <td>
                            <div class="d-flex align-items-center gap-2">
                                <img src="https://i.pravatar.cc/150?u=1" class="rounded-circle" width="28" height="28" />
                                <div>
                                    <div class="fw-bold small">John Doe</div>
                                    <div class="xx-small text-muted">john@example.com</div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <span class="badge bg-danger-subtle text-danger rounded-pill px-2 py-1 xx-small">High</span>
                        </td>
                        <td>
                            <span class="badge bg-primary-subtle text-primary rounded-pill px-2 py-1 xx-small">New</span>
                        </td>
                        <td class="text-center">
                            <div class="d-flex justify-content-center gap-1">
                                <button class="btn btn-icon btn-sm btn-ghost" title="@Localizer["ViewDetails"]"><i data-lucide="eye" class="w-4 h-4"></i></button>
                                <button class="btn btn-icon btn-sm btn-ghost text-success" title="@Localizer["MarkResolved"]"><i data-lucide="check" class="w-4 h-4"></i></button>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-bottom border-light">
                        <td class="ps-4 py-3">
                            <span class="font-monospace xx-small bg-light px-2 py-1 rounded">ERR-2026-XYZ</span>
                        </td>
                        <td>
                            <div class="d-flex align-items-center gap-2">
                                <img src="https://i.pravatar.cc/150?u=2" class="rounded-circle" width="28" height="28" />
                                <div>
                                    <div class="fw-bold small">Jane Smith</div>
                                    <div class="xx-small text-muted">jane@smith.com</div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <span class="badge bg-warning-subtle text-warning rounded-pill px-2 py-1 xx-small">Medium</span>
                        </td>
                        <td>
                            <span class="badge bg-info-subtle text-info rounded-pill px-2 py-1 xx-small">Pending</span>
                        </td>
                        <td class="text-center">
                            <div class="d-flex justify-content-center gap-1">
                                <button class="btn btn-icon btn-sm btn-ghost" title="@Localizer["ViewDetails"]"><i data-lucide="eye" class="w-4 h-4"></i></button>
                                <button class="btn btn-icon btn-sm btn-ghost text-success" title="@Localizer["MarkResolved"]"><i data-lucide="check" class="w-4 h-4"></i></button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof lucide !== 'undefined') lucide.createIcons();
            updateStats({ critical: 3, high: 8, inProgress: 12, resolved: 45 });
        });

        function updateStats(stats) {
            document.getElementById('criticalCount').textContent = stats.critical;
            document.getElementById('highCount').textContent = stats.high;
            document.getElementById('inProgressCount').textContent = stats.inProgress;
            document.getElementById('resolvedCount').textContent = stats.resolved;
        }
    </script>
}
