@using System.Globalization
@using Microsoft.Extensions.Localization
@inject IStringLocalizer<SharedResource> SharedLocalizer
<!DOCTYPE html>
<html lang="@CultureInfo.CurrentUICulture.TwoLetterISOLanguageName" dir="@(CultureInfo.CurrentUICulture.TextInfo.IsRightToLeft ? "rtl" : "ltr")" class="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - @SharedLocalizer["AppName"]</title>

    <!-- Theme initialization script (must be before any content) -->
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.classList.remove('light', 'dark');
            document.documentElement.classList.add(theme);
        })();
    </script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Alexandria:wght@100..900&display=swap" rel="stylesheet">

    <link rel="icon" type="image/png" href="~/images/logo/logo.png">
    <!-- Tailwind CSS -->
    <link rel="stylesheet" href="~/css/app.min.css" asp-append-version="true" />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Gradient Mesh Background */
        .auth-gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 75%, #00f2fe 100%);
            background-size: 400% 400%;
            animation: gradient-shift 15s ease infinite;
            position: relative;
            overflow: hidden;
        }

        .dark .auth-gradient-bg {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533483 75%, #1a1a2e 100%);
            background-size: 400% 400%;
        }

        @@keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Mesh overlay effect */
        .auth-gradient-bg::before {
            content: '';
            position: absolute;
            inset: 0;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(99, 102, 241, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(168, 85, 247, 0.2) 0%, transparent 50%);
            animation: mesh-float 20s ease-in-out infinite;
        }

        @@keyframes mesh-float {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.1); }
        }

        /* Glassmorphism card effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
        }

        .dark .glass-card {
            background: rgba(17, 24, 39, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        /* Button glow effect */
        .btn-glow {
            box-shadow: 0 0 20px rgba(225, 29, 72, 0.4);
            transition: all 0.3s ease;
        }

        /* Custom smoke particle styles */
        /* Global Page Transitions */
        .auth-view-transition {
            animation: view-entrance 0.6s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }

        @@keyframes view-entrance {
            0% { opacity: 0; transform: translateY(20px) scale(0.98); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* Responsive container height adjustment */
        .auth-container {
            min-height: calc(100vh - 4rem);
        }

        @@media (max-width: 640px) {
            .auth-container {
                padding-top: 6rem;
                padding-bottom: 0;
            }
        }

        .dark input {
            background-color: rgba(30, 41, 59, 0.6) !important;
            border-color: rgba(255, 255, 255, 0.1) !important;
        }

        .dark input:focus {
            background-color: rgba(30, 41, 59, 0.8) !important;
        }

        .fade-in {
            animation: fade-in-scale 0.4s ease-out forwards;
        }

        @@keyframes fade-in-scale {
            from { opacity: 0; transform: scale(0.95) translateY(-10px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
    </style>
    @await RenderSectionAsync("Styles", required: false)
</head>

<body class="font-sans antialiased auth-gradient-bg">
    <partial name="_Header" />
    
    <!-- Main container -->
    <div class="flex items-start justify-center w-full auth-container px-0 sm:px-4 pt-24 sm:pt-32 pb-10">
        <main class="w-full @(ViewData["FullWidth"] != null ? "max-w-6xl" : "max-w-md") auth-view-transition">
            <div class="glass-card rounded-b-3xl sm:rounded-3xl shadow-2xl overflow-hidden shadow-primary/10 border-white/20">
                @RenderBody()
            </div>
        </main>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/notifications.js" asp-append-version="true"></script>
    <script src="~/js/toaster.js" asp-append-version="true"></script>
    <script src="~/js/validation.js" asp-append-version="true"></script>
    <script>
        lucide.createIcons();
    </script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>