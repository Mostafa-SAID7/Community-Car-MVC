@using CommunityCar.Application.Features.Account.ViewModels.Social
@model FollowStatsVM

<div class="follow-button-container d-inline-block animate-in fade-in" data-user-id="@ViewBag.UserId">
    @if (Model.CanFollow)
    {
        <button onclick="toggleFollow('@ViewBag.UserId')" 
                id="follow-btn-@ViewBag.UserId"
                class="btn @(Model.IsFollowing ? "btn-light border" : "btn-primary-red shadow-sm") px-4 py-2 rounded-4 xx-small fw-black text-uppercase tracking-widest transition-all hover-scale-105 active-scale-95"
                data-following="@Model.IsFollowing.ToString().ToLower()"
                style="min-width: 120px;">
            @if (Model.IsFollowing)
            {
                <span class="following-text"><i class="fas fa-check me-2"></i>Following</span>
                <span class="unfollow-text d-none"><i class="fas fa-user-minus me-2"></i>Unfollow</span>
            }
            else
            {
                <span class="follow-text"><i class="fas fa-user-plus me-2"></i>Follow</span>
            }
        </button>
    }
    
    <div class="follow-stats mt-2 xx-small fw-bold text-muted opacity-60 text-uppercase tracking-widest d-flex align-items-center">
        <span id="followers-count-@ViewBag.UserId" class="text-dark fw-black">@Model.FollowersCount.ToString("N0")</span> <span class="ms-1">Followers</span>
        <span class="mx-2 opacity-25">â€¢</span>
        <span class="text-dark fw-black">@Model.FollowingCount.ToString("N0")</span> <span class="ms-1">Following</span>
        
        @if (Model.IsFollowedBy)
        {
            <span class="ms-3 badge rounded-pill bg-info bg-opacity-10 text-info border border-info border-opacity-20 px-2 py-1" style="font-size: 0.55rem;">
                Follows You
            </span>
        }
    </div>
</div>

<script>
    // Follow button hover effects
    document.addEventListener('DOMContentLoaded', function() {
        const followBtn = document.getElementById('follow-btn-@ViewBag.UserId');
        if (followBtn && followBtn.dataset.following === 'true') {
            followBtn.addEventListener('mouseenter', function() {
                const followingText = this.querySelector('.following-text');
                const unfollowText = this.querySelector('.unfollow-text');
                if (followingText && unfollowText) {
                    followingText.classList.add('d-none');
                    unfollowText.classList.remove('d-none');
                    this.classList.remove('btn-light');
                    this.classList.add('btn-danger', 'text-white');
                }
            });
            
            followBtn.addEventListener('mouseleave', function() {
                const followingText = this.querySelector('.following-text');
                const unfollowText = this.querySelector('.unfollow-text');
                if (followingText && unfollowText) {
                    followingText.classList.remove('d-none');
                    unfollowText.classList.add('d-none');
                    this.classList.remove('btn-danger', 'text-white');
                    this.classList.add('btn-light');
                }
            });
        }
    });
</script>

<style>
    .xx-small { font-size: 0.6rem; }
    .hover-scale-105:hover { transform: scale(1.05); }
    .active-scale-95:active { transform: scale(0.95); }
</style>