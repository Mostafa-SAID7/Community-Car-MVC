@using Microsoft.Extensions.Localization
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
@{
    // Get profile data from ViewBag or Model
    var profileData = ViewBag.ProfileData as CommunityCar.Application.Features.Account.ViewModels.Core.ProfileIndexVM;
    var fullName = profileData?.FullName ?? ViewBag.FullName as string ?? "User Profile";
    var email = profileData?.Email ?? ViewBag.Email as string ?? "user@example.com";
    var profilePictureUrl = profileData?.ProfilePictureUrl ?? ViewBag.ProfilePictureUrl as string;
    var createdAt = profileData?.CreatedAt ?? ViewBag.CreatedAt as DateTime? ?? DateTime.Now;
    var postsCount = profileData?.PostsCount ?? ViewBag.PostsCount as int? ?? 0;
    var commentsCount = profileData?.CommentsCount ?? ViewBag.CommentsCount as int? ?? 0;
    var likesReceived = profileData?.LikesReceived ?? ViewBag.LikesReceived as int? ?? 0;
}

<!-- Premium Profile Hero -->
<div class="position-relative mb-5 animate-in fade-in">
    <!-- Banner -->
    <div class="profile-banner position-relative overflow-hidden shadow-lg rounded-bottom-5" style="height: 280px; background: linear-gradient(135deg, var(--primary-red) 0%, #a81c24 100%);">
        <div class="position-absolute inset-0 opacity-10 pointer-events-none" style="background-image: url('https://www.transparenttextures.com/patterns/carbon-fibre.png');"></div>
        <div class="position-absolute inset-0 bg-gradient-to-t" style="background: linear-gradient(to top, rgba(0,0,0,0.4), transparent);"></div>
        
        <!-- Quick Actions Floating -->
        <div class="position-absolute top-0 end-0 p-4">
            <a href="/profile/settings" class="btn btn-blur-premium px-4 py-2 rounded-4 fw-black text-uppercase tracking-widest text-white shadow-xl opacity-hover-100 transition-all">
                <i class="fas fa-cog me-2"></i>@Localizer["Settings"]
            </a>
        </div>
    </div>

    <!-- Float Profile Info -->
    <div class="container-fluid px-4 px-md-5">
        <div class="d-flex flex-column flex-md-row align-items-md-end gap-4" style="margin-top: -80px; position: relative; z-index: 10;">
            <!-- Avatar Container -->
            <div class="position-relative">
                <div class="card card-premium p-1 p-md-2 border-0 shadow-2xl rounded-5" style="width: 180px; height: 180px;">
                    <div class="w-100 h-100 rounded-4 overflow-hidden border border-light border-2">
                        <img src="@(profilePictureUrl ?? "/images/default-avatar.png")?v=@DateTime.Now.Ticks" alt="@fullName" class="w-100 h-100 object-fit-cover hover-scale-110 transition-all duration-700" />
                    </div>
                </div>
                <!-- Status Badge -->
                <div class="position-absolute bottom-0 end-0 bg-success border border-4 border-white rounded-circle shadow-lg flex-center" style="width: 42px; height: 42px; transform: translate(5px, 5px);">
                    <i class="fas fa-bolt text-white small"></i>
                </div>
            </div>

            <!-- Profile Info Body -->
            <div class="flex-grow-1 pb-3">
                <div class="d-flex align-items-center gap-3 mb-1">
                    <h1 class="fw-black text-dark tracking-tight mb-0 display-6">@fullName</h1>
                    <span class="badge rounded-pill bg-primary-red bg-opacity-10 text-primary-red border border-primary-red border-opacity-20 xx-small fw-black text-uppercase tracking-widest px-3 py-2">@Localizer["Enthusiast"]</span>
                </div>
                <div class="d-flex flex-wrap align-items-center gap-4 text-muted small fw-bold mt-2">
                    <div class="d-flex align-items-center gap-2 opacity-hover-100 transition-all cursor-default">
                        <i class="fas fa-at opacity-50"></i>
                        @email
                    </div>
                    <div class="d-flex align-items-center gap-2 opacity-60">
                        <i class="fas fa-calendar-alt opacity-50"></i>
                        @Localizer["Joined"] @createdAt.ToString("MMM yyyy")
                    </div>
                </div>
            </div>

            <!-- Stats Bar (Hidden on mobile) -->
            <div class="d-none d-lg-block mb-3">
                <div class="card card-premium border-0 bg-white bg-opacity-70 backdrop-blur shadow-2xl rounded-4 p-3 px-5">
                    <div class="d-flex align-items-center gap-5">
                        <div class="text-center cursor-pointer group-stat">
                            <div class="h3 fw-black mb-0 text-dark group-hover-text-primary transition-all">@postsCount</div>
                            <div class="xx-small fw-black text-uppercase text-muted tracking-widest opacity-60">@Localizer["Posts"]</div>
                        </div>
                        <div class="vr bg-dark opacity-10" style="height: 40px;"></div>
                        <div class="text-center cursor-pointer group-stat">
                            <div class="h3 fw-black mb-0 text-dark group-hover-text-primary transition-all">@commentsCount</div>
                            <div class="xx-small fw-black text-uppercase text-muted tracking-widest opacity-60">@Localizer["Comments"]</div>
                        </div>
                        <div class="vr bg-dark opacity-10" style="height: 40px;"></div>
                        <div class="text-center cursor-pointer group-stat">
                            <div class="h3 fw-black mb-0 text-dark group-hover-text-primary transition-all">@likesReceived</div>
                            <div class="xx-small fw-black text-uppercase text-muted tracking-widest opacity-60">@Localizer["Likes"]</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .rounded-bottom-5 { border-bottom-left-radius: 2.5rem !important; border-bottom-right-radius: 2.5rem !important; }
    .btn-blur-premium { background: rgba(255,255,255,0.15); backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.2); }
    .btn-blur-premium:hover { background: rgba(255,255,255,0.25); border-color: rgba(255,255,255,0.3); }
    .hover-scale-110:hover { transform: scale(1.1); }
    .flex-center { display: flex; align-items: center; justify-content: center; }
    .shadow-2xl { box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); }
    .xx-small { font-size: 0.65rem; }
    .opacity-hover-100:hover { opacity: 1 !important; }
    .group-stat:hover .group-hover-text-primary { color: var(--primary-red) !important; }
</style>