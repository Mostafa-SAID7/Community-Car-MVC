@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model CommunityCar.Application.Features.Community.QA.ViewModels.QASearchVM
@{
    ViewData["Title"] = Localizer["PageTitle"];
    var searchRequest = ViewBag.SearchRequest as CommunityCar.Application.Features.Community.QA.ViewModels.QASearchVM;
}

<div class="animate-in fade-in duration-700">
    <!-- Header Section -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center gap-4 mb-5">
        <div>
            <h1 class="fw-black text-gradient tracking-tight display-6 mb-1">@Localizer["HeaderTitle"]</h1>
            <p class="small fw-bold text-muted opacity-75 mb-0">@Localizer["HeaderSubtitle"]</p>
        </div>
        <a asp-controller="QA" asp-action="Create" asp-route-culture="@System.Globalization.CultureInfo.CurrentCulture.Name" class="btn btn-primary-red px-4 py-3 rounded-4 fw-black text-uppercase tracking-widest small shadow-lg d-flex align-items-center gap-2 group">
            <i data-lucide="plus-circle" class="group-hover-scale-110 transition-transform" style="width: 18px;"></i>
            @Localizer["AskQuestion"]
        </a>
    </div>

    <!-- Stats Component -->
    <div class="mb-5">
        <partial name="~/Views/Community/QA/_QAStats.cshtml" model="Model.Stats" />
    </div>

    <!-- Filters Component -->
    <div class="mb-5">
        <partial name="~/Views/Community/QA/_QAFilters.cshtml" model="Model" />
    </div>

    <!-- Questions List -->
    <div id="questionsContainer" class="min-h-[400px]">
        <div id="qa-skeleton" class="d-none">
            <div class="row g-4">
                @for (int i = 0; i < 4; i++)
                {
                    <div class="col-12">
                        <skeleton type="Post" />
                    </div>
                }
            </div>
        </div>
        <div id="questions-list-container">
            <partial name="~/Views/Community/QA/_QuestionList.cshtml" model="Model" />
        </div>
    </div>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            if (typeof Skeleton !== 'undefined') {
                Skeleton.initPageLoad('qa-skeleton', 'questions-list-container');
            }
            
            lucide.createIcons();
            
            const toggleFiltersBtn = document.getElementById('toggleFiltersBtn');
            const filtersPanel = document.getElementById('filtersPanel');
            
            toggleFiltersBtn?.addEventListener('click', () => {
                toggleFiltersBtn.classList.toggle('btn-primary-red-subtle');
                toggleFiltersBtn.classList.toggle('text-primary-red');
                filtersPanel.classList.toggle('d-none');
            });
        });
    </script>
}
@section SidebarRight {
    <partial name="~/Views/Community/QA/_QASidebar.cshtml" />
}
