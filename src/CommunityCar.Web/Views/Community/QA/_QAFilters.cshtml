@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model CommunityCar.Application.Features.Community.QA.ViewModels.QASearchVM

@{
    var searchRequest = ViewBag.SearchRequest as CommunityCar.Application.Features.Community.QA.ViewModels.QASearchVM;
}

<!-- Discovery Toolbar -->
<div class="card card-premium p-4 border-0 shadow-sm mb-4">
    <div class="row g-3 align-items-center">
        <div class="col-lg">
            <div class="input-group input-group-lg shadow-sm rounded-4 overflow-hidden border">
                <span class="input-group-text bg-white border-0 ps-4">
                    <i data-lucide="search" class="text-muted opacity-50" style="width: 20px;"></i>
                </span>
                <input type="text" class="form-control border-0 bg-white small fw-bold py-3" placeholder="@Localizer["SearchPlaceholder"]" id="qaSearchInput" value="@(searchRequest?.SearchTerm ?? "")" style="box-shadow: none;">
            </div>
        </div>
        
        <div class="col-lg-auto">
            <button class="btn btn-white border rounded-4 px-4 py-3 small fw-black text-uppercase tracking-widest shadow-sm hover-translate-y-1 transition-all d-flex align-items-center justify-content-center gap-2 w-100" id="toggleFiltersBtn">
                <i data-lucide="sliders-horizontal" style="width: 16px;"></i>
                @Localizer["AdvancedFilters"]
            </button>
        </div>
    </div>

    <!-- Hidden Filters Expansion -->
    <div class="d-none pt-4 mt-4 border-top" id="filtersPanel animate-in slide-in-from-top-2">
        <div class="row g-4">
            <div class="col-sm-6 col-lg-3">
                <label class="x-small fw-black text-uppercase tracking-widest text-muted opacity-50 mb-2 d-block">@Localizer["SortBy"]</label>
                <select class="form-select rounded-4 border bg-light-subtle small fw-bold shadow-sm" id="sortFilter">
                    <option value="Newest" selected="@(searchRequest?.SortBy == CommunityCar.Domain.Enums.Community.QASortBy.Newest)">@Localizer["Newest"]</option>
                    <option value="MostVotes" selected="@(searchRequest?.SortBy == CommunityCar.Domain.Enums.Community.QASortBy.MostVotes)">@Localizer["MostVotes"]</option>
                    <option value="RecentActivity" selected="@(searchRequest?.SortBy == CommunityCar.Domain.Enums.Community.QASortBy.RecentActivity)">@Localizer["RecentActivity"]</option>
                </select>
            </div>
            
            <div class="col-sm-6 col-lg-3">
                <label class="x-small fw-black text-uppercase tracking-widest text-muted opacity-50 mb-2 d-block">@Localizer["Difficulty"]</label>
                <select class="form-select rounded-4 border bg-light-subtle small fw-bold shadow-sm" id="difficultyFilter">
                    <option value="">@Localizer["AllLevels"]</option>
                    <option value="Beginner">@Localizer["Beginner"]</option>
                    <option value="Expert">@Localizer["Expert"]</option>
                </select>
            </div>

            <div class="col-sm-6 col-lg-3">
                <label class="x-small fw-black text-uppercase tracking-widest text-muted opacity-50 mb-2 d-block">@Localizer["Status"]</label>
                <select class="form-select rounded-4 border bg-light-subtle small fw-bold shadow-sm" id="statusFilter">
                    <option value="">@Localizer["All"]</option>
                    <option value="Open">@Localizer["Open"]</option>
                    <option value="Solved">@Localizer["Solved"]</option>
                </select>
            </div>

            <div class="col-sm-6 col-lg-3">
                <label class="x-small fw-black text-uppercase tracking-widest text-muted opacity-50 mb-2 d-block">@Localizer["CarMake"]</label>
                <select class="form-select rounded-4 border bg-light-subtle small fw-bold shadow-sm" id="carMakeFilter">
                    <option value="">@Localizer["AllMakes"]</option>
                    @foreach (var make in Model.AvailableCarMakes)
                    {
                        <option value="@make">@make</option>
                    }
                </select>
            </div>
        </div>
        
        <div class="mt-4 pt-3 d-flex justify-content-end">
            <button class="btn btn-ghost btn-sm small fw-black text-uppercase tracking-widest px-4 border rounded-3" onclick="resetFilters()">
                @Localizer["ResetProtocol"]
            </button>
        </div>
    </div>
</div>