@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@model CommunityCar.Application.Features.Community.QA.ViewModels.QASearchVM

<div class="d-flex flex-column gap-4" id="questionsList">
    @if (Model.Questions.Any())
    {
        @foreach (var question in Model.Questions)
        {
            <partial name="~/Views/Community/QA/_QuestionCard.cshtml" model="question" />
        }

        @if (Model.Pagination.TotalPages > 1)
        {
            <div class="d-flex flex-column align-items-center mt-5 gap-3">
                <nav class="d-inline-flex align-items-center gap-1 p-2 bg-white border rounded-pill shadow-sm">
                    @if (Model.Pagination.HasPreviousPage)
                    {
                        <a href="javascript:void(0)" onclick="changePage(@(Model.Pagination.CurrentPage - 1))" 
                           class="btn btn-white border rounded-circle p-0 d-flex align-items-center justify-content-center shadow-sm hover-bg-light transition-all" style="width: 40px; height: 40px;">
                            <i data-lucide="chevron-left" style="width: 18px;"></i>
                        </a>
                    }

                    <div class="d-flex align-items-center gap-1 px-1">
                         @for (int i = Math.Max(1, Model.Pagination.CurrentPage - 2); i <= Math.Min(Model.Pagination.TotalPages, Model.Pagination.CurrentPage + 2); i++)
                         {
                            <a href="javascript:void(0)" onclick="changePage(@i)" 
                               class="btn @(i == Model.Pagination.CurrentPage ? "btn-primary-red shadow-sm scale-110" : "btn-white border") rounded-circle p-0 d-flex align-items-center justify-content-center fw-black small transition-all" style="width: 40px; height: 40px;">
                                @i
                            </a>
                         }
                    </div>

                    @if (Model.Pagination.HasNextPage)
                    {
                        <a href="javascript:void(0)" onclick="changePage(@(Model.Pagination.CurrentPage + 1))" 
                           class="btn btn-white border rounded-circle p-0 d-flex align-items-center justify-content-center shadow-sm hover-bg-light transition-all" style="width: 40px; height: 40px;">
                            <i data-lucide="chevron-right" style="width: 18px;"></i>
                        </a>
                    }
                </nav>
                <div class="x-small fw-black text-uppercase tracking-widest text-muted opacity-50">
                    @Localizer["Showing"] @Model.Pagination.StartItem-@Model.Pagination.EndItem @Localizer["Of"] @Model.Pagination.TotalItems @Localizer["Questions"]
                </div>
            </div>
        }
    }
    else
    {
        <div class="py-5 bg-light-subtle border border-2 border-dashed rounded-5 text-center px-4">
            <div class="bg-light rounded-circle d-flex align-items-center justify-content-center mx-auto mb-4 border" style="width: 80px; height: 80px;">
                <i data-lucide="help-circle" class="text-muted opacity-20" style="width: 40px;"></i>
            </div>
            <h3 class="fw-black text-dark mb-2 tracking-tight">@Localizer["NoQuestionsFound"]</h3>
            <p class="small text-muted mb-4 mx-auto" style="max-width: 320px;">@Localizer["TryAdjustingFilters"]</p>
            <button class="btn btn-primary-red px-5 py-3 rounded-pill fw-black text-uppercase tracking-widest small shadow-lg active-scale-95" onclick="resetFilters()">
                @Localizer["ClearFilters"]
            </button>
        </div>
    }
</div>
