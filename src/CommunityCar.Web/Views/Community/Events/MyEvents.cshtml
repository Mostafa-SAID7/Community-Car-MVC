@model IEnumerable<CommunityCar.Application.Features.Events.ViewModels.EventVM>
@{
    ViewData["Title"] = "My Events";
}

<div class="space-y-8 animate-in fade-in duration-700">
    <!-- Header Section -->
    <div class="flex flex-col md:flex-row md:items-center justify-between gap-6">
        <div>
            <h1 class="text-3xl font-black text-foreground tracking-tight">My Events</h1>
            <p class="text-sm text-muted-foreground font-medium opacity-70 mt-1">Events you've organized</p>
        </div>
        <a href="/events/create" class="inline-flex items-center gap-2.5 px-8 py-3 bg-primary text-primary-foreground hover:bg-primary/90 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all shadow-lg shadow-primary/20 active:scale-95 group">
            <i data-lucide="plus-circle" class="w-4 h-4 group-hover:scale-125 transition-transform"></i>
            Create New Event
        </a>
    </div>

    <!-- Events List -->
    <div id="events-skeleton" class="hidden space-y-6">
        <skeleton type="Card" />
        <skeleton type="Card" />
    </div>

    <div id="events-content">
    @if (Model.Any())
    {
        <div class="space-y-6">
            @foreach (var eventItem in Model)
            {
                <div class="bg-card/50 backdrop-blur-md border border-border rounded-2xl shadow-xl overflow-hidden hover:shadow-2xl transition-all duration-300">
                    <div class="p-6">
                        <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4">
                            <!-- Event Info -->
                            <div class="flex-1">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="flex-1">
                                        <h3 class="text-xl font-bold text-foreground mb-2">
                                            <a href="/events/@eventItem.Id" class="hover:text-primary transition-colors">@eventItem.Title</a>
                                        </h3>
                                        <p class="text-sm text-muted-foreground line-clamp-2 mb-3">@eventItem.Description</p>
                                    </div>
                                    
                                    <!-- Status Badge -->
                                    <div class="flex flex-col gap-2">
                                        @if (eventItem.IsUpcoming)
                                        {
                                            <span class="bg-green-500/10 text-green-600 dark:text-green-400 px-3 py-1 rounded-full text-xs font-medium">Upcoming</span>
                                        }
                                        else if (eventItem.IsActive)
                                        {
                                            <span class="bg-orange-500/10 text-orange-600 dark:text-orange-400 px-3 py-1 rounded-full text-xs font-medium">Active</span>
                                        }
                                        else
                                        {
                                            <span class="bg-gray-500/10 text-gray-600 dark:text-gray-400 px-3 py-1 rounded-full text-xs font-medium">Past</span>
                                        }
                                        
                                        @if (eventItem.IsFree)
                                        {
                                            <span class="bg-green-500/10 text-green-600 dark:text-green-400 px-3 py-1 rounded-full text-xs font-medium">FREE</span>
                                        }
                                        else if (eventItem.TicketPrice.HasValue)
                                        {
                                            <span class="bg-blue-500/10 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-full text-xs font-medium">$@eventItem.TicketPrice.Value</span>
                                        }
                                    </div>
                                </div>

                                <!-- Event Details -->
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                                    <div class="flex items-center gap-2 text-sm text-muted-foreground">
                                        <i data-lucide="calendar" class="w-4 h-4"></i>
                                        <span>@eventItem.StartTime.ToString("MMM dd, yyyy")</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-muted-foreground">
                                        <i data-lucide="map-pin" class="w-4 h-4"></i>
                                        <span>@eventItem.Location</span>
                                    </div>
                                    <div class="flex items-center gap-2 text-sm text-muted-foreground">
                                        <i data-lucide="users" class="w-4 h-4"></i>
                                        <span>@eventItem.AttendeeCount attendees</span>
                                        @if (eventItem.MaxAttendees.HasValue)
                                        {
                                            <span>/ @eventItem.MaxAttendees.Value max</span>
                                        }
                                    </div>
                                </div>

                                <!-- Tags -->
                                @if (eventItem.Tags.Any())
                                {
                                    <div class="flex flex-wrap gap-1 mb-4">
                                        @foreach (var tag in eventItem.Tags.Take(5))
                                        {
                                            <span class="bg-primary/10 text-primary px-2 py-1 rounded-full text-xs font-medium">#@tag</span>
                                        }
                                        @if (eventItem.Tags.Count() > 5)
                                        {
                                            <span class="text-xs text-muted-foreground">+@(eventItem.Tags.Count() - 5) more</span>
                                        }
                                    </div>
                                }
                            </div>

                            <!-- Action Buttons -->
                            <div class="flex flex-col sm:flex-row gap-2 lg:flex-col lg:w-48">
                                <a href="/events/@eventItem.Id" class="inline-flex items-center justify-center gap-2.5 px-4 py-2.5 bg-background border border-border hover:border-primary hover:text-primary rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-black/5 active:scale-95">
                                    <i data-lucide="eye" class="w-4 h-4"></i>
                                    View Details
                                </a>
                                
                                @if (eventItem.IsUpcoming)
                                {
                                    <a href="/events/@eventItem.Id/edit" class="inline-flex items-center justify-center gap-2.5 px-4 py-2.5 bg-primary text-primary-foreground hover:bg-primary/90 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-primary/20 active:scale-95">
                                        <i data-lucide="edit" class="w-4 h-4"></i>
                                        Edit Event
                                    </a>
                                }
                                
                                <form method="post" action="/events/@eventItem.Id/delete" class="inline" 
                                      onsubmit="return confirm('Are you sure you want to delete this event? This action cannot be undone.')">
                                    @Html.AntiForgeryToken()
                                    <button type="submit" class="w-full inline-flex items-center justify-center gap-2.5 px-4 py-2.5 bg-background border border-red-200 hover:border-red-300 text-red-600 hover:bg-red-50 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-black/5 active:scale-95">
                                        <i data-lucide="trash-2" class="w-4 h-4"></i>
                                        Delete
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="bg-card/50 backdrop-blur-md border border-border rounded-2xl p-8 text-center">
            <div class="bg-primary/10 p-4 rounded-full w-16 h-16 mx-auto mb-4 flex items-center justify-center">
                <i data-lucide="calendar-plus" class="w-8 h-8 text-primary"></i>
            </div>
            <h3 class="text-lg font-black text-foreground mb-2">No Events Yet</h3>
            <p class="text-sm text-muted-foreground mb-4">
                You haven't organized any events yet. Create your first event to bring the community together!
            </p>
            <div class="flex gap-2 justify-center">
                <a href="/events/create" class="inline-flex items-center gap-2.5 px-6 py-2.5 bg-primary text-primary-foreground hover:bg-primary/90 rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-primary/20 active:scale-95">
                    <i data-lucide="plus" class="w-4 h-4"></i>
                    Create Your First Event
                </a>
                <a asp-controller="Events" asp-action="Index" asp-route-culture="@System.Globalization.CultureInfo.CurrentCulture.Name" class="inline-flex items-center gap-2.5 px-6 py-2.5 bg-background border border-border hover:border-primary hover:text-primary rounded-xl text-xs font-black uppercase tracking-widest transition-all shadow-lg shadow-black/5 active:scale-95">
                    <i data-lucide="calendar" class="w-4 h-4"></i>
                    Browse All Events
                </a>
            </div>
        </div>
    }
    </div> <!-- End events-content -->
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            Skeleton.initPageLoad('events-skeleton', 'events-content');
        });
    </script>
}
