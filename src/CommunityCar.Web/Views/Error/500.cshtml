@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
@{
    ViewData["Title"] = Localizer["ServerErrorTitle"];
    ViewData["FullWidth"] = true;
    Layout = "_AuthLayout";
}

<!-- Responsive 500 Error Page - Mobile First Design -->
<div class="w-100 d-flex flex-column align-items-center justify-content-center p-3 p-sm-4 p-md-5" style="min-height: calc(100vh - 12rem);">
    
    <!-- Main 500 Content -->
    <div class="w-100 mx-auto vstack gap-4 gap-sm-5 animate-in fade-in" style="max-width: 56rem; animation-duration: 1s;">
        
        <!-- 500 Visual Section -->
        <div class="text-center vstack gap-4 gap-sm-5">
            <div class="position-relative d-inline-flex align-items-center justify-content-center">
                <!-- Destructive Anomaly Glow (Responsive) -->
                <div class="position-absolute bg-danger bg-opacity-10 rounded-circle animate-pulse" style="inset: -1.5rem; filter: blur(3rem);"></div>
                <div class="position-absolute bg-danger bg-opacity-5 rounded-circle animate-pulse" style="inset: -2.5rem; filter: blur(4rem); animation-delay: 150ms;"></div>
                
                <!-- Error Icon Container (Responsive) -->
                <div class="position-relative rounded-4 bg-white border border-danger border-opacity-20 d-flex align-items-center justify-content-center text-danger shadow-lg transition-transform" style="width: clamp(6rem, 20vw, 10rem); height: clamp(6rem, 20vw, 10rem); transform: rotate(3deg);">
                    <i data-lucide="flame" class="animate-bounce" style="width: clamp(2rem, 8vw, 5rem); height: clamp(2rem, 8vw, 5rem);"></i>
                    <i data-lucide="alert-triangle" class="position-absolute text-danger shadow-glow-destructive" style="width: clamp(1rem, 4vw, 2.5rem); height: clamp(1rem, 4vw, 2.5rem); top: -0.75rem; right: -0.75rem;"></i>
                </div>
            </div>
            
            <!-- Status Badge and Title (Responsive) -->
            <div class="vstack gap-3 gap-sm-4 px-3 px-sm-4">
                <div class="d-inline-flex align-items-center gap-2 px-3 py-2 bg-danger bg-opacity-10 border border-danger border-opacity-20 rounded-pill text-danger fw-black text-uppercase align-self-center" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em;">
                    <span class="rounded-circle bg-danger animate-ping" style="width: 8px; height: 8px;"></span>
                    @Localizer["SystemError"]
                </div>
                <h1 class="fw-black text-uppercase lh-sm" style="font-size: clamp(1.8rem, 6vw, 3.5rem); letter-spacing: -0.05em;">
                    @Localizer["ServerErrorHeading"]
                </h1>
                <p class="small fw-medium text-muted text-uppercase opacity-75 mx-auto lh-base" style="max-width: clamp(20rem, 60vw, 32rem); letter-spacing: 0.1em;">
                    @Localizer["ServerErrorDescription"]
                </p>
            </div>
        </div>

        <!-- Fault Isolation Panel (Responsive) -->
        <div class="card bg-dark text-white rounded-4 border-white border-opacity-10 p-3 p-sm-4 p-md-5 shadow-lg position-relative overflow-hidden mx-3 mx-sm-0">
            <div class="position-absolute top-0 start-0 w-100 h-100 bg-gradient-to-br from-danger opacity-5 pointer-events-none"></div>
            
            <!-- Console Header (Responsive) -->
            <div class="d-flex align-items-center justify-content-between mb-4 mb-sm-5 border-bottom border-white border-opacity-10 pb-3 pb-sm-4">
                <span class="fw-black text-uppercase text-danger animate-pulse" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em;">@Localizer["TacticalFailover"]</span>
                <div class="d-flex gap-2">
                    <div class="rounded-circle bg-white bg-opacity-10" style="width: 10px; height: 10px;"></div>
                    <div class="rounded-circle bg-white bg-opacity-10" style="width: 10px; height: 10px;"></div>
                    <div class="rounded-circle bg-white bg-opacity-10" style="width: 10px; height: 10px;"></div>
                </div>
            </div>
            
            <!-- Console Content (Responsive) -->
            <div class="vstack gap-4 gap-sm-5 font-monospace">
                <div class="vstack gap-2">
                    <span class="text-uppercase text-white text-opacity-25 fw-black" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em;">@Localizer["FaultVector"]</span>
                    <code class="d-block text-danger fw-black word-break-all" style="font-size: clamp(0.75rem, 2vw, 0.875rem);">@Localizer["ExceptionMessage"]</code>
                </div>
                <div class="vstack gap-2">
                    <span class="text-uppercase text-white text-opacity-25 fw-black" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em;">@Localizer["RecoveryProtocol"]</span>
                    <code class="d-block text-white text-opacity-50 lh-lg" style="font-size: clamp(0.75rem, 2vw, 0.875rem);">@Localizer["RecoveryMessage"]</code>
                </div>
            </div>
            
            <!-- Console Footer (Responsive) -->
            <div class="mt-4 mt-sm-5 pt-3 pt-sm-4 border-top border-white border-opacity-5 d-flex flex-column flex-sm-row align-items-center justify-content-between gap-3 gap-sm-4">
                <span class="text-uppercase text-white text-opacity-20 fw-black text-center text-sm-start" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.2em;">@Localizer["SystemArchive"]</span>
                <button onclick="location.reload()" class="btn btn-outline-light w-100 w-sm-auto px-4 px-sm-5 py-3 rounded-4 fw-black text-uppercase border-white border-opacity-10" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em; min-height: 44px;">
                    @Localizer["EmergencyRestart"]
                </button>
            </div>
        </div>

        <!-- Action Links (Responsive) -->
        <div class="d-flex flex-column flex-sm-row align-items-center justify-content-center gap-3 gap-sm-4 pt-2 pt-sm-4 px-3 px-sm-0">
            <a asp-controller="Feed" asp-action="Index" class="text-decoration-none text-uppercase fw-black text-muted hover-text-dark d-flex align-items-center gap-2" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em; min-height: 44px;">
                <i data-lucide="home" style="width: 1rem; height: 1rem;"></i> @Localizer["EscapeToHome"]
            </a>
            <div class="rounded-circle bg-border d-none d-sm-block" style="width: 6px; height: 6px;"></div>
            <a href="/contact" class="text-decoration-none text-uppercase fw-black text-muted hover-text-dark d-flex align-items-center gap-2" style="font-size: clamp(0.5rem, 1.5vw, 0.625rem); letter-spacing: 0.1em; min-height: 44px;">
                <i data-lucide="message-square" style="width: 1rem; height: 1rem;"></i> @Localizer["NotifySupport"]
            </a>
        </div>
    </div>
</div>

<!-- Custom Styles for 500 Page -->
<style>
    /* Enhanced responsive animations */
    @@keyframes fade-in {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .animate-in.fade-in {
        animation: fade-in 0.8s ease-out;
    }

    @@keyframes pulse {
        0%, 100% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.05); }
    }

    .animate-pulse {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    @@keyframes bounce {
        0%, 100% { transform: translateY(-10%); animation-timing-function: cubic-bezier(0.8, 0, 1, 1); }
        50% { transform: translateY(0); animation-timing-function: cubic-bezier(0, 0, 0.2, 1); }
    }

    .animate-bounce {
        animation: bounce 1s infinite;
    }

    @@keyframes ping {
        75%, 100% { transform: scale(2); opacity: 0; }
    }

    .animate-ping {
        animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
    }
    
    /* Mobile-specific improvements */
    @@media (max-width: 640px) {
        .word-break-all {
            word-break: break-all;
        }
        
        button, a {
            touch-action: manipulation;
        }
    }
    
    /* Prevent horizontal scroll */
    body {
        overflow-x: hidden;
    }
    
    /* Enhanced hover effects for desktop */
    @@media (min-width: 1024px) {
        .card:hover .animate-bounce {
            animation-duration: 0.8s;
        }
    }
    
    /* Dark mode optimizations */
    .dark .bg-dark {
        background-color: rgba(0, 0, 0, 0.98) !important;
    }
    
    .dark .shadow-glow-destructive {
        filter: drop-shadow(0 0 8px hsl(var(--destructive) / 0.6));
    }
</style>

@section Scripts {
    <script>
        // Initialize Lucide icons
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        }
        
        // Enhanced mobile interactions
        if ('ontouchstart' in window) {
            // Add touch feedback for buttons
            document.querySelectorAll('button, a').forEach(element => {
                element.addEventListener('touchstart', function() {
                    this.style.transform = 'scale(0.98)';
                });
                
                element.addEventListener('touchend', function() {
                    this.style.transform = '';
                });
            });
        }
        
        // Accessibility improvements
        document.addEventListener('keydown', function(e) {
            // Allow Enter key to trigger reload
            if (e.key === 'Enter' && e.target.tagName === 'BUTTON') {
                e.target.click();
            }
            
            // Allow Escape key to go home
            if (e.key === 'Escape') {
                window.location.href = '/';
            }
        });
        
        // Auto-refresh after 30 seconds (optional)
        setTimeout(function() {
            if (confirm('@Localizer["AutoRefreshConfirm"]')) {
                location.reload();
            }
        }, 30000);
    </script>
}
