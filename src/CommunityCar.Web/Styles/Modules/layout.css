/* ==========================================================================
   MODULE: LAYOUT & SIDEBARS
   ========================================================================== */

@layer base {
    .sidebar-backdrop {
        @apply fixed inset-0 bg-black/50 z-[35] opacity-0 pointer-events-none;
    }

    .sidebar-visible .sidebar-backdrop,
    .left-sidebar-visible .sidebar-backdrop,
    .right-sidebar-visible .sidebar-backdrop {
        @apply opacity-100 pointer-events-auto;
    }

    /* Left sidebar - hidden by default on mobile, visible on md+ screens */
    .sidebar {
        /* Mobile: hidden off-screen by default */
        transform: translateX(-100%);
        transition: transform 300ms ease-in-out;
    }

    /* RTL support for mobile sidebar */
    .rtl .sidebar {
        transform: translateX(100%);
    }

    @media (min-width: 768px) {
        .sidebar {
            /* Desktop: always visible, no transform needed */
            transform: none;
            transition: none;
        }

        .rtl .sidebar {
            transform: none;
        }
    }

    /* Mobile drawer behavior - only toggle transform on mobile */
    @media (max-width: 767px) {

        .sidebar-visible .sidebar,
        .left-sidebar-visible .sidebar {
            transform: translateX(0);
        }

        .rtl .sidebar-visible .sidebar,
        .rtl .left-sidebar-visible .sidebar {
            transform: translateX(0);
        }

        /* Add subtle backdrop effect when sidebar is open on mobile */
        .sidebar-visible #main-content,
        .left-sidebar-visible #main-content {
            opacity: 0.7;
            pointer-events: none;
        }

        /* Ensure main content is fully interactive when sidebar is closed */
        #main-content {
            opacity: 1;
            pointer-events: auto;
        }

        /* Better mobile spacing when sidebar is open */
        .sidebar-visible body,
        .left-sidebar-visible body {
            overflow: hidden;
            /* Prevent background scrolling */
        }
    }

    /* Right sidebar drawer behavior */
    .sidebar-right {
        transform: translateX(100%);
        /* Removed transition for animations */
    }

    @media (min-width: 1280px) {
        .sidebar-right {
            transform: translateX(0);
        }
    }

    .sidebar-visible .sidebar-right,
    .right-sidebar-visible .sidebar-right {
        transform: translateX(0);
        display: block;
    }

    /* Ensure right sidebar has proper scrolling */
    .sidebar-right {
        max-height: calc(100vh - 8rem);
        overflow-y: auto;
    }

    .sidebar-right .force-ltr {
        min-height: 100%;
        padding-bottom: 1rem;
    }

    /* Ensure main content has consistent width and spacing in both LTR and RTL */
    #main-content {
        max-width: none;
        width: auto;
        /* Let margins control the width */
    }

    /* Ensure content wrapper maintains consistent behavior */
    #main-content>div {
        max-width: none;
        width: 100%;
    }

    /* ========================================
     * IMPROVED MAIN CONTENT LAYOUT - NO OVERLAPPING
     * ======================================== */

    /* Mobile screens - full width, no sidebars visible */
    @media (max-width: 767px) {

        #main-content,
        main#main-content,
        main[role="main"],
        .main-content {
            margin-left: 0 !important;
            margin-right: 0 !important;
            padding-left: 1rem !important;
            padding-right: 1rem !important;
            width: 100% !important;
            max-width: 100% !important;
        }

        /* When sidebar is open on mobile, add overlay effect but no width change */
        .sidebar-visible #main-content,
        .left-sidebar-visible #main-content {
            opacity: 0.7;
            pointer-events: none;
        }
    }

    /* Tablet screens - left sidebar visible (64px width) */
    @media (min-width: 768px) and (max-width: 1279px) {

        #main-content,
        main#main-content,
        main[role="main"],
        .main-content {
            margin-left: 5rem !important;
            /* 80px for left sidebar + gap */
            margin-right: 0 !important;
            padding-left: var(--space-page) !important;
            padding-right: var(--space-page) !important;
            width: calc(100% - 5rem) !important;
            /* Subtract left margin */
            max-width: calc(100% - 5rem) !important;
        }

        /* RTL support for tablet */
        .rtl #main-content,
        .rtl main#main-content,
        .rtl main[role="main"],
        .rtl .main-content {
            margin-left: 0 !important;
            margin-right: 5rem !important;
            /* 80px for left sidebar + gap */
            padding-left: 1rem !important;
            padding-right: 1.5rem !important;
            width: calc(100% - 5rem) !important;
            max-width: calc(100% - 5rem) !important;
        }
    }

    /* Large screens - both sidebars visible */
    @media (min-width: 1280px) {

        #main-content,
        main#main-content,
        main[role="main"],
        .main-content {
            margin-left: 15rem !important;
            /* 240px for left sidebar + gap */
            margin-right: 24rem !important;
            /* 320px for right sidebar + 2rem gap to prevent overlap */
            padding-left: 1.5rem !important;
            padding-right: 1.5rem !important;
            width: calc(100% - 39rem) !important;
            /* Subtract both margins */
            max-width: calc(100% - 39rem) !important;
            min-width: 320px !important;
            /* Minimum content width */
        }

        /* When right sidebar is hidden, adjust right margin */
        .xl\:mr-0 #main-content,
        .xl\:mr-0 main#main-content,
        .xl\:mr-0 main[role="main"],
        .xl\:mr-0 .main-content {
            margin-right: 1rem !important;
            width: calc(100% - 16rem) !important;
            /* Only subtract left margin */
            max-width: calc(100% - 16rem) !important;
        }

        /* RTL support for large screens */
        .rtl #main-content,
        .rtl main#main-content,
        .rtl main[role="main"],
        .rtl .main-content {
            margin-left: 24rem !important;
            /* 320px for right sidebar + 2rem gap to prevent overlap */
            margin-right: 15rem !important;
            /* 240px for left sidebar + gap */
            width: calc(100% - 39rem) !important;
            max-width: calc(100% - 39rem) !important;
        }

        .rtl.xl\:mr-0 #main-content,
        .rtl.xl\:mr-0 main#main-content,
        .rtl.xl\:mr-0 main[role="main"],
        .rtl.xl\:mr-0 .main-content {
            margin-left: 1rem !important;
            width: calc(100% - 16rem) !important;
            max-width: calc(100% - 16rem) !important;
        }
    }

    /* Ensure content wrapper respects the calculated width */
    #main-content>div,
    main#main-content>div,
    main[role="main"]>div,
    .main-content>div {
        width: 100% !important;
        max-width: 100% !important;
        min-width: 0 !important;
        overflow-x: hidden !important;
        box-sizing: border-box !important;
    }

    /* Sidebar positioning */
    .sidebar {
        position: fixed !important;
        left: 1rem !important;
        top: 5rem !important;
        bottom: 1.25rem !important;
        width: 4rem !important;
        z-index: 50 !important;
    }

    @media (min-width: 1280px) {
        .sidebar {
            width: 14rem !important;
        }
    }

    .sidebar-right {
        position: fixed !important;
        right: 1rem !important;
        top: 5rem !important;
        bottom: 2rem !important;
        width: 20rem !important;
        z-index: 40 !important;
    }

    /* RTL sidebar positioning */
    .rtl .sidebar {
        left: auto !important;
        right: 1rem !important;
    }

    .rtl .sidebar-right {
        right: auto !important;
        left: 1rem !important;
    }

    /* Main content container improvements */
    #main-content {
        min-width: 0;
        overflow-x: hidden;
        opacity: 1 !important;
        visibility: visible !important;
        display: block !important;
        box-sizing: border-box;
    }
}